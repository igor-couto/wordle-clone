function loadGameBoard(){const n=document.querySelectorAll(".row");game.boardState.forEach((t,i)=>{if(t!==""&&n[i]){const r=n[i].querySelectorAll(".row-letter");t.split("").forEach((n,t)=>{r[t]&&(r[t].textContent=n.toUpperCase())});game.status===GameStatus.Won}});currentRow=getCurrentRow();currentTile=getNextEmptyTile(currentRow)}async function submitGuess(n){if(n.length!==5){setMessage("Word must be 5 letters!");return}if(game.boardState.includes(n)){setMessage("You have already guessed this word.");return}try{const t=await fetch(`https://localhost:53120/guess?word=${n}`);if(!t.ok){if(t.status==404){const n=await t.json();setMessage(n.message);return}throw new Error("Network response was not ok");}const i=await t.json();updateTiles(i);game.boardState[currentRow.rowIndex]=n;window.localStorage.setItem("game",JSON.stringify(game));i.isCorrect?(game.status=GameStatus.Won,game.boardState[currentRow.rowIndex]=n,setMessage("Congratulations, you won!")):(currentRow=getCurrentRow(),currentTile=getNextEmptyTile(currentRow),game.boardState[currentRow.rowIndex-1]=n);window.localStorage.setItem("game",JSON.stringify(game))}catch(t){console.error("Fetch error:",t);setMessage(t)}}function updateTiles(n){const t=currentRow.querySelectorAll(".row-letter");n.letters.forEach((n,i)=>{let r;switch(n.letterPlacement){case LetterPlacement.Correct:r="letter-correct";updateKeyboardButtonStatus(n.character,r);break;case LetterPlacement.Incorrect:r="letter-elsewhere";updateKeyboardButtonStatus(n.character,r);break;case LetterPlacement.NotPresent:r="letter-not-present";updateKeyboardButtonStatus(n.character,r)}t[i].classList.add(r);t[i].textContent=n.character.toUpperCase()})}function updateKeyboardButtonStatus(n,t){buttons.forEach(i=>{i.textContent.toUpperCase()===n.toUpperCase()&&(i.classList.contains("letter-correct")||(i.classList.remove("letter-elsewhere","letter-not-present"),i.classList.add(t)))})}function handleOnScreenKeyboard(n){if(game.status===GameStatus.InProgress){const i=n.target,t=i.textContent;if(t==="Enter"){submitGuess(getCurrentGuess());return}if(t==="âŒ«"){deleteLastLetter();return}currentTile&&t.length===1&&(currentTile.textContent=t.toUpperCase(),currentTile=getNextEmptyTile(currentRow))}}function handleKeyboardInput(n){if(game.status===GameStatus.InProgress){const t=n.key;currentTile&&t.match(/^[a-zA-Z]$/)?(currentTile.textContent=t.toUpperCase(),currentTile=getNextEmptyTile(currentRow)):t==="Enter"?submitGuess(getCurrentGuess()):t==="Backspace"&&deleteLastLetter()}}function deleteLastLetter(){if(!currentRow||game.status!==GameStatus.InProgress)return"";const n=Array.from(currentRow.querySelectorAll(".row-letter"));for(let t=n.length-1;t>=0;t--)if(n[t].textContent.trim()){n[t].textContent="";currentTile=n[t];break}}function getCurrentGuess(){if(!currentRow||game.status===GameStatus.Won)return"";const n=currentRow.querySelectorAll(".row-letter");return Array.from(n).map(n=>n.textContent.trim()).join("")}function getCurrentRow(){const n=document.querySelectorAll(".row");for(let t=0;t<n.length;t++){const i=n[t].querySelectorAll(".row-letter"),r=Array.from(i).some(n=>!n.textContent.trim());if(r)return n[t]}return null}function getNextEmptyTile(n){const t=n.querySelectorAll(".row-letter");for(let n of t)if(!n.textContent.trim())return n;return null}function setMessage(n){document.getElementById("message").textContent=n}function generateUuid(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,n=>(n^crypto.getRandomValues(new Uint8Array(1))[0]&15>>n/4).toString(16))}const GameStatus={InProgress:0,Won:1,Lost:2},LetterPlacement={Correct:0,Incorrect:1,NotPresent:2};let currentRow=getCurrentRow(),currentTile=getNextEmptyTile(currentRow),game={sessionId:generateUuid(),status:GameStatus.InProgress,boardState:["","","","","",""]};window.localStorage.getItem("game")?(game=JSON.parse(window.localStorage.getItem("game")),loadGameBoard()):window.localStorage.setItem("game",JSON.stringify(game));const buttons=document.querySelectorAll(".game-keyboard-button");document.addEventListener("keydown",handleKeyboardInput);buttons.forEach(n=>{n.addEventListener("click",handleOnScreenKeyboard)})